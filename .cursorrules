Техническое задание: Геологический разрез по карте и легенде
1. Цель проекта
Создать веб-приложение, которое строит упрощённый геологический разрез по изображению геологической карты, изображению легенды и двум заданным точкам на карте. Разрез не отображает реальную геометрию (наклоны, высоты), а визуализирует последовательность слоёв согласно порядку цветов в легенде.

2. Описание работы
Входные данные от пользователя:
Изображение геологической карты (формат PNG).

Изображение легенды с цветами геологических формаций (PNG).

Две точки на карте (в пиксельных координатах) — начало и конец линии разреза.

Алгоритм обработки:
Извлечение цветов из легенды — порядок цветов сверху вниз определяет порядок слоёв (младше — выше).

Построение линии между двумя точками — извлекается список пикселей вдоль линии.

Анализ цветов вдоль линии — каждый цвет сопоставляется с ближайшим цветом из легенды.

Построение слоёв — при смене цвета:

Если новый цвет выше в легенде — новый слой рисуется выше.

Если ниже — ниже текущего.

Повторяющиеся цвета игнорируются (не добавляются снова).

Визуализация — итоговый геологический разрез строится как вертикальная диаграмма, где каждый слой окрашен согласно легенде.

3. Функциональные модули
Загрузка карты и легенды

Выбор двух точек на карте

Кластеризация и упрощение палитры легенды (если необходимо)

Анализ линии разреза

Сопоставление цветов по LAB-пространству

Визуализация упрощённого геологического разреза

4. Ограничения
Не строится реальная геометрия разреза (нет рельефа и углов падения).

Только формат PNG.

Цвета карты должны присутствовать в легенде.

Порядок слоёв строго следует порядку в легенде сверху вниз.

5. Технологический стек
Backend:
FastAPI — REST API

Uvicorn — сервер ASGI

Pydantic — валидация данных

OpenCV — работа с изображениями

NumPy — численные операции

Pillow (PIL) — базовая обработка изображений

scikit-learn — кластеризация (KMeans) при необходимости

OCR (опционально для распознавания подписей):
PaddleOCR — распознавание кириллицы

Tesseract — резервный OCR

Прочее:
LAB color space — сопоставление цветов карты и легенды

Matplotlib / SVG / Pillow — визуализация разреза

НЕ СОЗДАВАЙ НИКАКИХ ТЕСТОВЫХ ФАЙЛОВ ИЛИ ПРОЕКТОВ.